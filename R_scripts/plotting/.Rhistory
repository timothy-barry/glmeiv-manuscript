x_grid <- seq(-1.2, 1.7, 0.01)
to_plot <- rbind(data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "mRNA",
Status = "Unperturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = -0.4, sd = 0.25),
modality = "mRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 1, sd = 0.25),
modality = "gRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "gRNA",
Status = "Unperturbed")) %>% dplyr::mutate(modality = factor(x = modality, levels = c("mRNA", "gRNA")))
library(magrittr)
library(ggplot2)
library(cowplot)
my_cols <- c("firebrick3", "dodgerblue3", "orchid4", "lightskyblue3")
fig_dir <- paste0(.get_config_path("LOCAL_CODE_DIR"), "glmeiv-manuscript/figures/analysis_challenges")
if (!dir.exists(fig_dir)) dir.create(fig_dir)
# a. create mixture distributions
x_grid <- seq(-1.2, 1.7, 0.01)
to_plot <- rbind(data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "mRNA",
Status = "Unperturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = -0.4, sd = 0.25),
modality = "mRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 1, sd = 0.25),
modality = "gRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "gRNA",
Status = "Unperturbed")) %>% dplyr::mutate(modality = factor(x = modality, levels = c("mRNA", "gRNA")))
my_cols <- c("royalblue4", "seagreen4")
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = my_cols) + geom_line(lwd = 1.1)
p1
my_theme <- theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
my_cols <- c("firebrick3", "dodgerblue3", "orchid4", "lightskyblue3")
fig_dir <- paste0(.get_config_path("LOCAL_CODE_DIR"), "glmeiv-manuscript/figures/analysis_challenges")
if (!dir.exists(fig_dir)) dir.create(fig_dir)
# a. create mixture distributions
x_grid <- seq(-1.2, 1.7, 0.01)
to_plot <- rbind(data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "mRNA",
Status = "Unperturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = -0.4, sd = 0.25),
modality = "mRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 1, sd = 0.25),
modality = "gRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "gRNA",
Status = "Unperturbed")) %>% dplyr::mutate(modality = factor(x = modality, levels = c("mRNA", "gRNA")))
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = my_cols) + geom_line(lwd = 1.1)
p1
ggsave(filename = paste0(fig1_dir, "density_plot.pdf"), plot = p1, device = "pdf", scale = 1, width = 4, height = 4) + my_theme
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "mRNA"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = my_cols) + geom_line(lwd = 1.1) + my_theme
p1
gene
x_grid <- seq(-1.2, 1.7, 0.01)
to_plot <- rbind(data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "gene",
Status = "Unperturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = -0.4, sd = 0.25),
modality = "gene",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 1, sd = 0.25),
modality = "gRNA",
Status = "Perturbed"),
data.frame(x = x_grid,
y = dnorm(x = x_grid, mean = 0, sd = 0.25),
modality = "gRNA",
Status = "Unperturbed")) %>% dplyr::mutate(modality = factor(x = modality, levels = c("gene", "gRNA")))
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = my_cols) + geom_line(lwd = 1.1) + my_theme
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) + my_theme
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[4])) + geom_line(lwd = 1.1) + my_theme
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) + my_theme
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.14, 0.34), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.75, 0.75), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.75, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line() +
theme(legend.position = c(0.75, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.75, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
# set up cowplot
p_out <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"))
p_out
# set up cowplot
p_out <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0.005, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0.05, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0.5, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(NA, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(NA, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, NA)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.1)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.01)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
p1
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line =  element_blank())
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.x = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw(base_size = 10) +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
fig_dir
fig_dir
f_name <- paste0(fig_dir, "/ggplot.jpg")
f_name
f_name
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 6, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.4, 0.6))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
f_name <- paste0(fig_dir, "/ggplot.jpg")
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1.1, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 0.8, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 0.9, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 0.95, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 0.96, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
# set up cowplot
p_right <- plot_grid(NULL, p1, ncol = 1, labels = c("b", "c"), rel_heights = c(0.5, 0.5))
p_out <- plot_grid(NULL, p_right, ncol = 2, labels = c("a", ""))
p_out
p_out <- plot_grid(NULL, NULL, p1, NULL, labels = c("a", "b", "c", "d"), ncol = 2)
p_out
p_out <- plot_grid(NULL, NULL, p1, NULL, labels = c("a", "c", "b", "d"), ncol = 2)
p_out
p_out <- plot_grid(NULL, p1 NULL, NULL, labels = c("a", "b", "c", "d"), nrow = 2)
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "b", "c", "d"), nrow = 2)
p_out
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "b", "c", "d"), nrow = 2, rel_heights = c(0.6, 0.4))
p_out
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.6, 0.4))
p_out
f_name <- paste0(fig_dir, "/ggplot.jpg")
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 6, height = 5, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 6.5, height = 5.5, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 6.5, height = 6.0, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 5.5, dpi = 320)
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
# set up cowplot
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.6, 0.4))
f_name <- paste0(fig_dir, "/ggplot.jpg")
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
# set up cowplot
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.5, 0.5))
f_name <- paste0(fig_dir, "/ggplot.jpg")
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], my_cols[3])) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], "black")) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
p1
# set up cowplot
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.5, 0.5))
p_out
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) + scale_x_continuous(expand = c(0, 0.05)) +
scale_color_manual(values = c(my_cols[2], "black")) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
p1
p1 <- ggplot(data = to_plot, mapping = aes(x = x, y = y, col = Status)) +
facet_grid(modality~.) + ylab("Density") + xlab("Expression") + theme_bw() +
theme(legend.position="bottom") + theme(legend.position="bottom", legend.title=element_blank()) +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = -0.4), col = "darkred") +
geom_vline(data = dplyr::filter(to_plot, modality == "gene"), mapping = aes(xintercept = 0.0), col = "darkred") +
geom_hline(yintercept = 0) + scale_y_continuous(expand = c(0, 0.05)) + scale_x_continuous(expand = c(0, 0)) +
scale_color_manual(values = c(my_cols[2], "black")) + geom_line(lwd = 1.1) +
theme(legend.position = c(0.77, 0.85), legend.title = element_blank(),
panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line.y = element_line(colour = "black"))
p1
# set up cowplot
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.5, 0.5))
f_name <- paste0(fig_dir, "/ggplot.jpg")
ggsave(filename = f_name, plot = p_out, device = "jpg", scale = 1, width = 7, height = 6, dpi = 320)
# set up cowplot
p_out <- plot_grid(NULL, p1, NULL, NULL, labels = c("a", "c", "b", "d"), nrow = 2, rel_heights = c(0.5, 0.5))
f_name <- paste0(fig_dir, "/ggplot.pdf")
ggsave(filename = f_name, plot = p_out, device = "pdf", scale = 1, width = 7, height = 6, dpi = 320)
